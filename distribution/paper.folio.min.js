var folio=folio||{},Setup=function(){},Draw=function(){},Update=function(){},Animate=function(){},AnimateClear=function(){},onMouseUp=function(){},onMouseDown=function(){},onMouseMove=function(){},onMouseDrag=function(){},onKeyDown=function(){},onKeyUp=function(){};paper.install(window);window.onload=function(){function a(){var a=document.getElementById("canvas"),b=a.parentNode;a.getContext&&(a.width=b.offsetWidth,a.height=b.offsetHeight);for(a=0;a<projects.length;a++)for(b=0;b<projects[a].layers.length;b++)projects[a].layers[b].removeChildren();"function"==typeof Setup&&Setup();"function"==typeof Draw&&Draw();view.draw()}paper.setup("canvas");console.log("Folio.js is go!");"function"==typeof Setup&&Setup();"function"==typeof Draw&&Draw();(new Group).name="__AnimationGroup";view.onFrame=function(a){"function"==typeof Update&&Update(a);project.activeLayer.children.__AnimationGroup&&project.activeLayer.children.__AnimationGroup.remove()};view.onResize=function(a){"function"==typeof onResize&&onResize(a)};var b=new Tool;b.onMouseUp=function(a){"function"==typeof onMouseUp&&onMouseUp(a)};b.onMouseDown=function(a){"function"==typeof onMouseDown&&onMouseDown(a)};b.onMouseMove=function(a){"function"==typeof onMouseMove&&onMouseMove(a)};b.onMouseDrag=function(a){"function"==typeof onMouseDrag&&onMouseDrag(a)};b.onKeyDown=function(a){"function"==typeof onKeyDown&&onKeyDown(a)};b.onKeyUp=function(a){"function"==typeof onKeyUp&&onKeyUp(a)};view.draw();var c;window.onresize=function(){clearTimeout(c);c=setTimeout(a,100)};a()};folio={FTime:{},FIO:{},F3D:{}};PaperScope.inject({enumerable:!0,println:function(a){console.log(a);console.log("\n")},boolToInt:function(a){return a?1:0},numToBool:function(a){return 0!=a?!0:!1},getType:function(a){return"object"==typeof a?a instanceof paper.Point?"Point":a instanceof paper.Size?"Size":a instanceof paper.Rectangle?"Rectangle":a instanceof Group?"Group":a instanceof paper.PlacedItem?"PlacedItem":a instanceof paper.Raster?"Raster":a instanceof paper.PlacedSymbol?"PlacedSymbol":a instanceof paper.Path?"Path":a instanceofpaper.CompoundPath?"CompoundPath":a instanceof paper.Symbol?"Symbol":a instanceof paper.TextItem?"TextItem":"undefined":typeof a},findByName:function(a,b){for(var c,d=0;d<a.length;d++){var e=a[d];e.name==b&&(c=e)}return c},findById:function(a,b){for(var c,d=0;d<a.length;d++){var e=a[d];e.id==b&&(c=e)}return c}});Array.prototype.median=function(){return this.sort(),0===this.length%2?(this[this.length/2-1]+this[this.length/2])/2:this[(this.length-1)/2]};Array.prototype.unique=function(){var a=[],b=0,c=this.length;a:for(;c>b;b++){for(var d=0,e=a.length;e>d;d++)if(a[d]==this[b])continue a;a[a.length]=this[b]}return a};Array.prototype.merge=function(a){a=this.concat(a);return a.shuffle(),a};Array.prototype.max=function(a,b){a=void 0!=a?a:0;b=void 0!=b?b:this.length;for(var c=this[a],d=a+1;b>d;d++)this[d]>c&&(c=d);return c};Array.prototype.min=function(a,b){a=void 0!=a?a:0;b=void 0!=b?b:this.length;for(var c=this[a],d=a+1;b>d;d++)this[d]<c&&(c=d);return c};Array.prototype.shuffle=function(){for(var a,b,c=this.length;c;a=parseInt(Math.random()*c),b=this[--c],this[c]=this[a],this[a]=b);};Array.prototype.removeDuplicates=function(){return this.reduce(function(a,b){return-1===a.indexOf(b)&&a.push(b),a},[])};Array.prototype.round=function(a){a=Math.pow(10,a);for(var b=0;b<this.length;b++)this[b]=Math.round(this[b]*a)/a;return this};var FSort={alphabetical:function(a,b){return a=a.toLowerCase(),a=a.replace(/\u00e4/g,"a"),a=a.replace(/\u00f6/g,"o"),a=a.replace(/\u00fc/g,"u"),a=a.replace(/\u00df/g,"s"),b=b.toLowerCase(),b=b.replace(/\u00e4/g,"a"),b=b.replace(/\u00f6/g,"o"),b=b.replace(/\u00fc/g,"u"),b=b.replace(/\u00df/g,"s"),a==b?0:a>b?1:-1},distanceToCenter:function(a,b){var c=a.distanceToCenter();console.log(c);var d=b.distanceToCenter();console.log(d);var e=0;return c>d?e=-1:d>c&&(e=1),e}};PaperScope.inject({enumerable:!0,random:function(a,b){return void 0==b&&(b=a,a=0),a+Math.random()*(b-a)},randomInt:function(a,b){return parseInt(paper.random(a,b))},randomBias:function(a,b,c){var d=[90,9,4,2.33,1.5,1,0.66,0.43,0.25,0.11,0.01];c=10*Math.max(0,Math.min(c,1));var e=parseInt(Math.floor(c)),f=d[e];return 10>c&&(f+=(d[e+1]-f)*(c-e)),Math.pow(Math.random(),f)*(b-a)+a},clamp:function(a,b,c){return b>a?b:a>c?c:a},normalize:function(a,b,c){return(a-b)/(c-b)},map:function(a,b,c,d,e){return d+(a-b)/(c-b)*(e-d)},round:function(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c},roundMultiple:function(a,b){return Math.floor(a/b)*b+b},snap:function(a,b,c){c=c||Math.round;return paper.round(b*c(a/b),2)},interpolate:function(a,b,c){return a+(b-a)*c},divisor:function(a){for(var b=[],c=[],d=Math.floor(Math.sqrt(a)),e=1;d>=e;e++)0==a%e&&(b.push(e),e*e!=a&&c.push(a/e));return c.reverse(),b.concat(c)},degrees:function(a){return 180/Math.PI*a},radians:function(a){return Math.PI/180*a},sec:function(a){return 1/Math.cos(a)},cosec:function(a){return 1/Math.sin(a)},sq:function(a){return a*a},getCommonTangents:function(a,b){var c=b.position.x-a.position.x,d=b.position.y-a.position.y,e=Math.sqrt(a.bounds.size.getArea()),f=Math.sqrt(b.bounds.size.getArea()),e=e/2,f=f/2,g=a.position.getDistance(b.position);if(!(g<=Math.abs(f-e))){var c=Math.atan2(d,c),h=Math.acos((e-f)/g),g=new Point(a.position.x+e*Math.cos(c+h),a.position.y+e*Math.sin(c+h)),d=new Point(b.position.x+f*Math.cos(c+h),b.position.y+f*Math.sin(c+h)),e=new Point(a.position.x+e*Math.cos(c-h),a.position.y+e*Math.sin(c-h)),f=new Point(b.position.x+f*Math.cos(c-h),b.position.y+f*Math.sin(c-h));return[g,d,f,e]}}});paper.Color.inject({componentToHex:function(a){a=a.toString(16);return 1==a.length?"0"+a:a},colorToHex:function(){var a,b,c,d="";try{a=255*this.red,b=255*this.green,c=255*this.blue,d="#"+this.componentToHex(a)+this.componentToHex(b)+this.componentToHex(c)}catch(e){console.log(e)}return d},colorToInt:function(){var a;try{a=this.red,a<<=8,a|=this.green,a<<=8,a|=this.blue}catch(b){console.log(b),a=16777215}return a},integer:function(a){return this.red=255&a>>16,this.green=255&a>>8,this.blue=255&a,this},bytes:function(a,b,c,d){return this.red=a/255,this.green=void 0!=b?b/255:a/255,this.blue=void 0!=c?c/255:a/255,this.alpha=void 0!=d?d/255:1,this},desaturate:function(a){var b=new Color(this);return b.saturation=paper.clamp(this.saturation-this.saturation*a,0,1),b},saturate:function(a){var b=new Color(this);return b.saturation=paper.clamp(this.saturation+this.saturation*a,0,1),b},darken:function(a){var b=new Color(this);return b.lightness=paper.clamp(this.lightness-this.lightness*a,0,1),b},dim:function(a){var b=new Color(this);return b.brightness=paper.clamp(this.brightness-this.brightness*a,0,1),b},lighten:function(a){var b=new Color(this);return b.lightness=paper.clamp(this.lightness+this.lightness*a,0,1),b},brighten:function(a){var b=new Color(this);return b.saturation=paper.clamp(this.saturation-this.saturation*a,0,1),b.brightness=paper.clamp(this.brightness+this.brightness*a,0,1),b},contrast:function(a){var b=new Color(this);return 0.5>b.lightness?b.darken(a):b.lighten(a)},invert:function(){for(var a=new Color(this),b=0;b<a._components.length;b++)a._components[b]=1-a._components[b];return a},rotate:function(a){var b=new Color(this);return b.hue+=a,b},interpolate:function(a,b,c){var d=new Color(this);if("number"==typeof b){a=a.getComponents();for(var e=0;e<d._components.length;e++)d._components[e]=paper.interpolate(d._components[e],a[e],b)}else{var f=a.getComponents();a=b.getComponents();for(e=0;e<d._components.length;e++)d._components[e]=paper.interpolate(f[e],a[e],c)}return d.setType(this.type),d},random:function(){this._components[0]="hsb"==this.type||"hsl"==this.type?paper.random(this._components[0],360):paper.random(this._components[0],1);for(var a=1;a<this._components.length;a++)this._components[a]=paper.random(this._components[a],1);return this}});var FConversions={PIXEL_TO_MM:0.352777778,MM_TO_PIXEL:2.83464567,POINT_TO_MM:this.PIXEL_TO_MM,MM_TO_POINT:this.MM_TO_PIXEL,PIXEL_TO_CM:0.0352777778,CM_TO_PIXEL:28.3464567,POINT_TO_CM:this.PIXEL_TO_CM,CM_TO_POINT:this.CM_TO_PIXEL,PIXEL_TO_INCH:0.0138888889,INCH_TO_PIXEL:72,POINT_TO_INCH:this.PIXEL_TO_INCH,INCH_TO_POINT:this.INCH_TO_PIXEL,PIXEL_TO_PICA:0.0833333333,PICA_TO_PIXEL:12,POINT_TO_PICA:this.PIXEL_TO_PICA,PICA_TO_POINT:this.PICA_TO_PIXEL};paper.Item.inject({snapGrid:function(a){this.position.snapGrid(a)},snapIso:function(a){this.position.snapIso(a)},getDistanceToCenter:function(){return this._position.getDistance(view.bounds.center)},toGroup:function(){return"CompoundPath"==folio.getType(this)?new Group(this.children):this}});paper.Path.inject({getCentroid:function(){var a=new Point(0,0),b=0,c=0,d=[],e=0;for(e;e<this._segments.length-1;++e)d[0]=this._segments[e].point,d[1]=this._segments[e+1].point,c=d[0].x*d[1].y-d[1].x*d[0].y,b+=c,a.x+=(d[0].x+d[1].x)*c,a.y+=(d[0].y+d[1].y)*c;return d[0]=this._segments[e].point,d[1]=this._segments[0].point,c=d[0].x*d[1].y-d[1].x*d[0].y,b+=c,a.x+=(d[0].x+d[1].x)*c,a.y+=(d[0].y+d[1].y)*c,b*=0.5,a.x/=6*b,a.y/=6*b,a},getCircumcenter:function(){function a(a,b,c){return a>=b&&a>=c?a:b>=a&&b>=c?b:c}function b(a,b,c){return b>=a&&c>=a?a:a>=b&&c>=b?b:c}if(3===this._segments.length){var c=this._segments[0].point,d=this._segments[1].point,e=this._segments[2].point,f=d.x-c.x,g=d.y-c.y,h=e.x-c.x,l=e.y-c.y,k=f*(c.x+d.x)+g*(c.y+d.y),n=h*(c.x+e.x)+l*(c.y+e.y),m=2*(f*(e.y-d.y)-g*(e.x-d.x));return Math.abs(m)<Numerical.EPSILON?(f=b(c.x,d.x,e.x),g=b(c.y,d.y,e.y),h=a(c.x,d.x,e.x),c=a(c.y,d.y,e.y),Point.create((f+h)/2,(g+c)/2)):Point.create((l*k-g*n)/m,(f*n-h*k)/m)}return null},getIncircle:function(){for(var a=Number.MAX_VALUE,b=0;b<this._segments.length;b++){var c=this._segments[b].point;c.getDistance(this.getCentroid())<a&&(a=c.getDistance(this.getCentroid()))}return Path.Circle(this.getCentroid(),a)},statics:new function(){return{FArrow:function(a,b,c){var d=new Path.Line(a,b);c=void 0!=c?c:new Size(0.381924*a.getDistance(b),0.381924*a.getDistance(b));b=Math.atan2(a.x-b.x,b.y-a.y);var e=[];e[0]=new Path.Line(new Point(0,0),new Point(-c.width,-c.height));e[1]=new Path.Line(new Point(0,0),new Point(c.width,-c.height));for(c=0;c<e.length;c++)e[c].rotate(180+paper.degrees(b),new Point(0,0)),e[c].translate(a);a=new Group([d,e[0],e[1]]);return a.name="arrow",a},FBubble:function(a,b,c,d){var e=new Path;e.name="bubble";c=void 0!=c?c:defaultFBubbleTagSize;10>b.width&&(b.width=10,c=new Size(10,10));d=void 0!=d?d:"RANDOM";e.add(new Point(0,0));var f=180,g=new Point(b.height/2+Math.cos(paper.radians(f))*b.height,b.height/2+Math.sin(paper.radians(f))*b.height);e.arcTo(g,new Point(0,b.height));g=paper.randomInt(0,b.width-c.width);e.add(new Point(g,b.height));var h,l;return h="LEFT"==d?g:"CENTER"==d?g+c.width/2:"RIGHT"==d?g+c.width:paper.randomInt(g,g+c.width),l=b.height+c.height,e.add(new Point(h,l)),e.add(new Point(g+c.width,b.height)),e.add(new Point(b.width,b.height)),f=0,new Point(b.height/2+Math.cos(paper.radians(f))*(b.height/2),b.height/2+Math.sin(paper.radians(f))*(b.height/2)),e.arcTo(new Point(b.width,0),!1),e.closed=!0,e.position=new Point(a.x,a.y+c.height/2),e},FChain:function(a,b,c,d){var e,f;"Point"==a.type?(e=new Path.Circle(a,b),f=new Path.Circle(c,d)):(e=a,f=b);a=paper.getCommonTangents(e,f);b=new Path;null!=a&&(b.name="chain",b.add(a[0]),b.add(a[1]),angle=f.position.x>e.position.x?0:f.position.y<e.position.y?-90:f.position.y>e.position.y?90:180,c=new Point(f.position.x+Math.cos(paper.radians(angle))*(f.bounds.width/2),f.position.y+Math.sin(paper.radians(angle))*(f.bounds.height/2)),b.arcTo(c,a[2]),b.add(a[2]),b.add(a[3]),angle=e.position.x>f.position.x?0:e.position.y<f.position.y?-90:e.position.y>f.position.y?90:180,e=new Point(e.position.x+Math.cos(paper.radians(angle))*(e.bounds.width/2),e.position.y+Math.sin(paper.radians(angle))*(e.bounds.height/2)),b.arcTo(e,a[0]),b.closed);return b},FCross:function(a,b,c,d){var e,f;"LINE"==d?(e=new Path.Line(a.x+b.width,a.y-b.height,a.x-b.width,a.y+b.height),e.strokeWidth=c,f=new Path.Line(a.x+b.width,a.y+b.height,a.x-b.width,a.y-b.height),f.strokeWidth=c):"SHARP"==d&&(e=new Path,e.add(new Point(a.x+b.width,a.y-b.height)),e.add(new Point(a.x+b.width,a.y-b.height+c/2)),e.add(new Point(a.x-b.width+c/2,a.y+b.height)),e.add(new Point(a.x-b.width,a.y+b.height)),e.add(new Point(a.x-b.width,a.y+b.height-c/2)),e.add(new Point(a.x+b.width-c/2,a.y-b.height)),e.closed=!0,f=new Path,f.add(new Point(a.x-b.width,a.y-b.height)),f.add(new Point(a.x-b.width+c/2,a.y-b.height)),f.add(new Point(a.x+b.width,a.y+b.height-c/2)),f.add(new Point(a.x+b.width,a.y+b.height)),f.add(new Point(a.x+b.width-c/2,a.y+b.height)),f.add(new Point(a.x-b.width,a.y-b.height+c/2)),f.closed=!0);a=new Group([e,f]);return a.name="cross",a},FDrop:function(a,b){var c=new Path;return c.name="drop",c.add(new Segment(new Point(-0.01,0.01),new Point(0,-0.0055078),new Point(0,0.643042))),c.add(new Segment(new Point(-0.65,1.6381104),new Point(0,-0.6109619),new Point(0,0.3694434))),c.add(new Segment(new Point(0,2.31),new Point(-0.3578369,0),new Point(0.3578369,0))),c.add(new Segment(new Point(0.65,1.6381104),new Point(0,0.3694434),new Point(0,-0.6109619))),c.add(new Segment(new Point(0.01,0.01),new Point(0,0.643042),new Point(0,-0.0055078))),c.add(new Segment(new Point(0,-0),new Point(0.0055078,0),new Point(-0.0055078,0))),c.closed=!0,c.position=a,"Size"==typeof b?c.scale(b.width,b.height):c.scale(b),c},FTriangle:function(a,b,c){var d=new Path;return d.add(a),d.add(b),d.add(c),d.closed=!0,d.name="triangle",d}}}});paper.Point.inject({name:null,data:{},snap:function(a,b){a="Size"==a.type?a:new Size(a,a);var c,d;return!0===optons.isometric?(c=Math.round(this.y/(16*a.height)-this.x/(32*a.width)),d=Math.round(this.y/(16*a.height)+this.x/(16*a.width)),this.x=(d-c)/2*32*a.width,this.y=(d+c)/2*16*a.height):(c=Math.round(this.y/a.height-this.x/a.width),d=Math.round(this.y/a.height+this.x/a.width),this.x=(d-c)/2*a.width,this.y=(d+c)/2*a.height),this},interpolateTo:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this},getDistanceToCenter:function(){return this.getDistance(view.bounds.center)},getHeading:function(){return-1*Math.atan2(-this.y,this.x)},getAngle:function(a){return Math.atan2(a.y-this.y,a.x-this.x)},norm:function(a,b){return this.x=paper.normalize(this.x,a.x,b.x),this.y=paper.normalize(this.y,a.y,b.y),this},magSq:function(){return this.x*this.x+this.y*this.y}});paper.Size.inject({getArea:function(){return this.width*this.height},getCircumarea:function(){var a=this.getCircumradius();return Math.PI*a*a},getIncirclearea:function(){var a=this.getIncircleradius();return Math.PI*a*a},getCircumradius:function(){var a=this.width,b=this.height;return Math.sqrt(a*a+b*b)/2},getIncircleradius:function(){return this.width<this.height?this.width/2:this.height/2},getSlopeAngle:function(){return Math.atan(this.width/this.height)}});String.prototype.trimEnd=function(){for(var a=this.length-1;" "==this.charAt(a);a--)this.substring(0,a);return this};String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/gi,""),this.replace(/[ ]{2,}/gi," "),this.replace(/\n /,"\n"),this};String.prototype.toBool=function(){switch(this.toLowerCase()){case "true":case "yes":case "1":return!0;case "false":case "no":case "0":case null:return!1;default:return Boolean(this)}};paper.TextItem.inject({trimToFit:function(){return this.content=this.visibleRange.content.trim(),this}});folio.FTime={FDate:{},FStopwatch:{},FStepper:{},Ease:{}};folio.FTime.Ease=function(){return{linear:function(a){return a},inQuad:function(a){return a*a},outQuad:function(a){return a*(2-a)},inOutQuad:function(a){return 0.5>a?2*a*a:-1+(4-2*a)*a},inCubic:function(a){return a*a*a},outCubic:function(a){return--a*a*a+1},inOutCubic:function(a){return 0.5>a?4*a*a*a:(a-1)*(2*a-2)*(2*a-2)+1},inQuart:function(a){return a*a*a*a},outQuart:function(a){return 1- --a*a*a*a},inOutQuart:function(a){return 0.5>a?8*a*a*a*a:1-8*--a*a*a*a},inQuint:function(a){return a*a*a*a*a},outQuint:function(a){return 1+--a*a*a*a*a},inOutQuint:function(a){return 0.5>a?16*a*a*a*a*a:1+16*--a*a*a*a*a},inSine:function(a){return-1*Math.cos(Math.PI/2*a)+1},outSine:function(a){return 1*Math.sin(Math.PI/2*a)},inOutSine:function(a){return-0.5*(Math.cos(Math.PI*a)-1)},inExpo:function(a){return 1*Math.pow(2,10*(a-1))},outExpo:function(a){return 1*(-Math.pow(2,-10*a)+1)},inOutExpo:function(a){return a/=0.5,1>a?0.5*Math.pow(2,10*(a-1)):(a--,0.5*(-Math.pow(2,-10*a)+2))},inCirc:function(a){return-1*(Math.sqrt(1-a*a)-1)},outCirc:function(a){return a--,1*Math.sqrt(1-a*a)},inOutCirc:function(a){return a/=0.5,1>a?-0.5*(Math.sqrt(1-a*a)-1):(a-=2,0.5*(Math.sqrt(1-a*a)+1))},spline:function(a,b){function c(a,b,c){return(((1-3*c+3*b)*a+(3*c-6*b))*a+3*b)*a}var d;return a instanceof Array?d=a:(a=a.normalize(),b=b.normalize(),d=[a.x,a.y,b.x,b.y]),{get:function(a){if(d[0]!=d[1]||d[2]!=d[3]){a:{for(var b=a,g=0;4>g;++g){var h;h=d[0];var l=d[2];h=3*(1-3*l+3*h)*b*b+2*(3*l-6*h)*b+3*h;if(0==h){a=b;break a}l=c(b,d[0],d[2])-a;b-=l/h}a=b}a=c(a,d[1],d[3])}return a}}}}};folio.FTime.FDate=function(){var a=new Date,b=function(a){return 1==a.length&&(a="0"+a),a},c=function(){void 0===a&&(a=new Date);return String(a.getFullYear())},d=function(){return void 0===a&&(a=new Date),String(a.getMonth())},e=function(){return void 0===a&&(a=new Date),String(a.getDate())},f=function(){void 0===a&&(a=new Date);var c=String(a.getHours());return b(c)},g=function(){void 0===a&&(a=new Date);var c=String(a.getMinutes());return b(c)},h=function(){void 0===a&&(a=new Date);var c=String(a.getSeconds());return b(c)},l=function(a,b,c){return void 0===b&&void 0===c&&(a=k(a)[0],b=k(a)[1],c=k(a)[2]),parseInt(36E5*a+6E4*b+1E3*c)},k=function(a){a=a.split(":");return[a[0],a[1],a[2]]};return{year:c,month:d,day:e,hour:f,minute:g,second:h,date:function(){return c()+d()+e()},now:function(a){a=a||[!0,!0,!0];var b="";return a[0]&&(b+=f()),a[0]&&a[1]&&(b+=":"),a[1]&&(b+=g()),a[1]&&a[2]&&(b+=":"),a[2]&&(b+=h()),b},nowMilliseconds:function(){return l(f(),g(),h())},add:function(b,c,d,k){return a+(24*b+60*c+60*d+1E3*k)},sub:function(b,c,d,k){return a-(24*b+60*c+60*d+1E3*k)},set:function(a,b,c,d){return time=new Date,time.setTime(24*a+60*b+60*c+1E3*d),time},get:function(a,b){var c=b||[!0,!0,!0],d=parseInt(a/1E3%60),k=parseInt(a/1E3/60%60),e=parseInt(a/1E3/60/60%24),q="";return c[0]&&(q+=10>e?"0"+e:""+e),c[0]&&c[1]&&(q+=":"),c[1]&&(q+=10>k?"0"+k:""+k),c[1]&&c[2]&&(q+=":"),c[2]&&(q+=10>d?"0"+d:""+d),q},toMillsecond:l,toArray:k}};folio.FTime.FStepper=function(){var a=1E3,b=0,c=0,d=!1,e=!1,f=!1,g=1,h=0,l=function(){e=d=!0;f=!1},k=function(){f=d=!0;e=!1},n=function(b){a=b;a/=1E3};return{delta:function(){return g},counter:function(){return h},toggle:function(){return 0===c?(c=1,k()):(c=0,l()),c},update:function(c){if(d&&(d=!1,b=e?paper.round(c+(1-g)*a,3):paper.round(c+g*a,3),c>=b&&(e?(e=!1,g=1):(f=!1,g=0))),e){if(g=paper.round(1-(b-c)/a,3),c==b)return e=!1,g=1,h++,void 0}else if(f&&(g=paper.round((b-c)/a,3),c==b))return e=!1,g=0,h++,void 0},stepIn:l,stepOut:k,isIn:function(){return e},isOut:function(){return f},isDone:function(){return 1>g&&0<g?!1:1<g?(g=1,!0):0>g?(g=0,!0):void 0},stop:function(){d=e=f=!1},setSeconds:function(a){n(parseInt(1E3*a))},setMillis:n,setDelta:function(a){g=a}}};folio.FTime.FStopwatch=function(){var a,b,c=0,d=0,e=function(){0==d?f():g()},f=function(){d=1;b=new Date;b.setTime(b.getTime()-c)},g=function(){d=0;a=new Date;c=a.getTime()-b.getTime()};return{toggle:e,start:f,pause:g,reset:function(){c=d=0},set:function(a,f){c=a;d=1==f?0:1;b=new Date;b.setTime(b.getTime()-c);e()},get:function(){return 1==d&&(a=new Date,c=a.getTime()-b.getTime()),c},isRunning:function(){return d?!0:!1}}};folio.FIO={saveLocal:function(a,b){window.localStorage?localStorage.setItem(a,String(b)):console.error("localStorage not supported")},getLocal:function(a){return localStorage.getItem(a)},getLocalInt:function(a){return parseInt(getLocal(a))},getLocalFloat:function(a){return parseFloat(getLocal(a))},getAllLocal:function(){return sessionStorage},deleteLocal:function(a){localStorage.removeItem(a)},saveSession:function(a,b){window.sessionStorage?sessionStorage.setItem(a,String(b)):console.error("sessionStorage not supported")},getSession:function(a){return sessionStorage.getItem(a)},getSessionInt:function(a){return parseInt(getSession(a))},getSessionFloat:function(a){return parseFloat(getSession(a))},getAllSession:function(){return sessionStorage},deleteSession:function(a){sessionStorage.removeItem(a)},saveCookie:function(a,b,c){if(c){var d=new Date;d.setTime(d.getTime()+864E5*c);c="; expires="+d.toGMTString()}else c="";document.cookie=a+"="+b+c+"; path=/"},openCookie:function(a){a+="=";for(var b=document.cookie.split(";"),c=0;c<b.length;c++){for(var d=b[c];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}},deleteCookie:function(a){saveCookie(a,"",-1)},saveFile:function(a,b){var c=new File(script.file.parent,b);c.exists()&&c.remove();c.open();c.write(Json.encode(a));c.close()},openFile:function(a){a=new File(script.file.parent,a);a.open();var b=Json.decode(a.readAll());return a.close(),b},deleteFile:function(a){a=new File(script.file.parent,a);a.exists()&&a.remove()},checkFile:function(a){return(new File(script.file.parent,a)).exists()?!0:!1}};folio.FCirclePacker=function(a,b){b=void 0!=b?b:11;var c=0.1,d=0;return{update:function(){a=a.sort(folio.distanceToCenter);for(var e=new Point,f=a.length-1;0<=f;--f)for(var g=a[f],h=g.position,l=f+1;l<a.length;l++){var k=a[l],n=k.position;if(f!=l){var m=n.x-h.x,r=n.y-h.y,k=g.bounds.size.width/2+k.bounds.size.width/2+d,s=m*m+r*r;if(k*k-0.01>s){e.x=m;e.y=r;e=e.normalize(1);e=e.multiply(0.5*(k-Math.sqrt(s)));try{n.x+=e.x,n.y+=e.y,h.x-=e.x,h.y-=e.y}catch(t){a.slice(l,1);break}}}}g=c/Number(b);for(f=0;f<a.length;f++)h=a[f].position,e.x=h.x-artboard.bounds.center.x,e.y=h.y-artboard.bounds.center.y,e=e.multiply(g),h.x-=e.x,h.y-=e.y},add:function(b){"array"==typeof b?a=a.concat(b):a.push(b)},setDamping:function(a){c=a},setPadding:function(a){d=a},getItems:function(){return a},getItem:function(b){return a[b]}}};folio.FRoute=function(a,b){b=void 0!=b?b:1E3;var c=0,d=[],e;if(0==c){for(var d=0,f=[a.length],g=0;g<a.length;++g){f[g]=!1;var h=a[g].position.x,l=a[g].position.y;h>=view.bounds.width||l>=view.bounds.height||0>h||0>l||(f[g]=!0,d++)}d=[d];for(g=h=0;g<a.length;++g)f[g]&&(d[h]=g,h++)}f=d.length-1;if(c<d.length-2){var k=c+1E3;k>f&&(k=f);for(g=c;k>g;++g){e=a[d[c]].position;for(var n=0,m=Number.MAX_VALUE,r=c+1;f>r;++r){var l=a[d[r]].position,h=e.x-l.x,l=e.y-l.y,s=h*h+l*l;m>s&&(n=r,m=s)}e=d[c+1];d[c+1]=d[n];d[n]=e;f>c?c++:console.log("Now optimizing plot path")}}for(g=0;b>g;++g)if(c=Math.floor(Math.random()*f),k=Math.floor(Math.random()*f),!(2>Math.abs(c-k))){c>k&&(e=k,k=c,c=e);var r=a[d[c]].position,n=a[d[c+1]].position,t=a[d[k]].position,m=a[d[k+1]].position,h=r.x-n.x,l=r.y-n.y,s=h*h+l*l,h=t.x-m.x,l=t.y-m.y,s=s+(h*h+l*l),h=r.x-t.x,l=r.y-t.y,r=h*h+l*l;if(h=n.x-m.x,l=n.y-m.y,r+=h*h+l*l,s>r)for(h=k,l=c+1;h>l;)e=d[l],d[l]=d[h],d[h]=e,h--,l++}return{route:d}};var EPSILON=1E-6;folio.FTriangulate=function(a){function b(){if(e=[],null!=f.length){f=d(f);f.sort(c);var a=f[0].x,b=f[0].y,m=a,r=b;f[0].z;for(var s=0;s<f.length;s++){var t=f[s];t.x<a&&(a=t.x);t.x>m&&(m=t.x);t.y<b&&(b=t.y);t.y>r&&(r=t.y)}s=m-a;t=r-b;s=s>t?s:t;t=(m+a)/2;r=(r+b)/2;e=[];b=new HashSet;r=new h(new Point(t-2*s,r-s),new Point(t,r+2*s),new Point(t+2*s,r-s));e.push(r);a=[];for(s=0;s<f.length;s++){for(var t=f[s],a=[],u=new Point,m=e.length-1;0<=m;m--){var q=e[m];if(!b.contains(q)){var z;z=t;var p=q,w=u,v=void 0,A=void 0,B=void 0,D=void 0,C=void 0,E=void 0,x=void 0,y=void 0,F=void 0,G=void 0;z=Math.abs(p.p1.y-p.p2.y)<EPSILON&&Math.abs(p.p2.y-p.p3.y)<EPSILON?!1:(Math.abs(p.p2.y-p.p1.y)<EPSILON?(A=-(p.p3.x-p.p2.x)/(p.p3.y-p.p2.y),D=(p.p2.x+p.p3.x)/2,E=(p.p2.y+p.p3.y)/2,w.x=(p.p2.x+p.p1.x)/2,w.y=A*(w.x-D)+E):Math.abs(p.p3.y-p.p2.y)<EPSILON?(v=-(p.p2.x-p.p1.x)/(p.p2.y-p.p1.y),B=(p.p1.x+p.p2.x)/2,C=(p.p1.y+p.p2.y)/2,w.x=(p.p3.x+p.p2.x)/2,w.y=v*(w.x-B)+C):(v=-(p.p2.x-p.p1.x)/(p.p2.y-p.p1.y),A=-(p.p3.x-p.p2.x)/(p.p3.y-p.p2.y),B=(p.p1.x+p.p2.x)/2,D=(p.p2.x+p.p3.x)/2,C=(p.p1.y+p.p2.y)/2,E=(p.p2.y+p.p3.y)/2,w.x=(v*B-A*D+E-C)/(v-A),w.y=v*(w.x-B)+C),x=p.p2.x-w.x,y=p.p2.y-w.y,F=x*x+y*y,w.z=Math.sqrt(F),x=z.x-w.x,y=z.y-w.y,G=x*x+y*y,F>=G);u.x+u.z<t.x&&b.add(q);z&&(a.push(new l(q.p1,q.p2)),a.push(new l(q.p2,q.p3)),a.push(new l(q.p3,q.p1)),e.splice(m,1))}}a.sort();for(m=1;m<a.length;)a[m-1].p1==a[m].p1&&a[m-1].p2==a[m].p2||a[m-1].p1==a[m].p2&&a[m-1].p2==a[m].p2?a.splice(m,1):m++;for(m=0;m<a.length-1;m++)for(q=a[m],u=m+1;u<a.length;u++)v=a[u],q.p1==v.p2&&q.p2==v.p1&&(q.p1=null,q.p2=null,v.p1=null,v.p2=null),q.p1==v.p1&&q.p2==v.p2&&(q.p1=null,q.p2=null,v.p1=null,v.p2=null);for(m=0;m<a.length;m++)if(q=a[m],null!=q.p1&&null!=q.p2){for(u=0;u<g.length;u++)q.p1.name=q.p1==g[u]?"__new":null,q.p2.name=q.p2==g[u]?"__new":null,t.name=t==g[u]?"__new":null;e.push(new h(q.p1,q.p2,t))}}for(s=e.length-1;0<=s;s--)q=e[s],q.sharesVertex(r)&&e.splice(s,1)}}function c(a,b){return a.x<b.x?1:a.x>b.x?-1:0}function d(a){a.sort();for(var b=1;b<a.length;)a[b-1].x==a[b].x&&a[b-1].y==a[b].y?a.splice(b,1):b++;return a}var e,f=a,g=[],h=function(a,b,c){return{p1:a,p2:b,p3:c,sharesVertex:function(d){return a==d.p1||a==d.p2||a==d.p3||b==d.p1||b==d.p2||b==d.p3||c==d.p1||c==d.p2||c==d.p3},getCentroid:function(){return new Point((a.x+b.x+c.x)/3,(a.y+b.y+c.y)/3)},getArea:function(){var d=0;return d+=(a.x+c.x)*(c.y-a.y),d+=(b.x+a.x)*(a.y-b.y),d+=(c.x+b.x)*(b.y-c.y),d/2},getWidth:function(){var d=0;a.x<b.x&&a.x<c.x?d=a.x:b.x<a.x&&b.x<c.x?d=b.x:c.x<a.x&&c.x<b.x&&(d=c.x);var e=0;a.x>b.x&&a.x>c.x?e=a.x:b.x>a.x&&b.x>c.x?e=b.x:c.x>a.x&&c.x>b.x&&(e=c.x);return Math.abs(e-d)},getHeight:function(){var d=0;a.y<b.y&&a.y<c.y?d=a.y:b.y<a.y&&b.y<c.y?d=b.y:c.y<a.y&&c.y<b.y&&(d=c.y);var e=0;a.y>b.y&&a.y>c.y?e=a.y:b.y>a.y&&b.y>c.y?e=b.y:c.y>a.y&&c.y>b.y&&(e=c.y);return Math.abs(e-d)},getPoints:function(){return[a,b,c]}}},l=function(a,b){var c=a.getDistance(b);return{p1:a,p2:b,dist:c,getPoints:function(){return[a,b]}}};return b(),{add:function(a){g=[];a instanceofArray?(g=a,f=f.concat(a)):(g[0]=a,f.push(a));f=d(f);b()},getTriangles:function(a){return null!=a?e[a]:e},getPoints:function(a){return null!=a?f[a]:f},getClosest:function(a){for(var b,c=0;c<e.length;c++)for(var d=a.getCentroid.getDistance(e[c].getCentroid),f=0;f<e.length;f++){var g=e[f],h=a.getCentroid.getDistance(g.getCentroid);if(d>h){b=g;break}}return b}}};var HashSet=function(){var a=[];return{add:function(b){-1==a.indexOf(b)&&a.push(b)},get:function(b){return a[b]},size:function(){return a.length},remove:function(b){b=a.indexOf(b);-1!=b&&a.splice(b,1)},contains:function(b){for(var c=!1,d=0;d<a.length;d++)a[d]===b&&(c=!0);return c},toString:function(){return a.join(",")}}},Matrix3D=function(a,b,c,d,e,f,g,h,l,k,n,m,r,s,t,u){this.n11=a||1;this.n12=b||0;this.n13=c||0;this.n14=d||0;this.n21=e||0;this.n22=f||1;this.n23=g||0;this.n24=h||0;this.n31=l||0;this.n32=k||0;this.n33=n||1;this.n34=m||0;this.n41=r||0;this.n42=s||0;this.n43=t||0;this.n44=u||1;this.clone=function(){return new Matrix3D(this.n11,this.n12,this.n13,this.n14,this.n21,this.n22,this.n23,this.n24,this.n31,this.n32,this.n33,this.n34,this.n41,this.n42,this.n43,this.n44)};this.concat=function(a){var b={};b.n11=this.n11*a.n11+this.n12*a.n21+this.n13*a.n31+this.n14*a.n41;b.n12=this.n11*a.n12+this.n12*a.n22+this.n13*a.n32+this.n14*a.n42;b.n13=this.n11*a.n13+this.n12*a.n23+this.n13*a.n33+this.n14*a.n43;b.n14=this.n11*a.n14+this.n12*a.n24+this.n13*a.n34+this.n14*a.n44;b.n21=this.n21*a.n11+this.n22*a.n21+this.n23*a.n31+this.n24*a.n41;b.n22=this.n21*a.n12+this.n22*a.n22+this.n23*a.n32+this.n24*a.n42;b.n23=this.n21*a.n13+this.n22*a.n23+this.n23*a.n33+this.n24*a.n43;b.n24=this.n21*a.n14+this.n22*a.n24+this.n23*a.n34+this.n24*a.n44;b.n31=this.n31*a.n11+this.n32*a.n21+this.n33*a.n31+this.n34*a.n41;b.n32=this.n31*a.n12+this.n32*a.n22+this.n33*a.n32+this.n34*a.n42;b.n33=this.n31*a.n13+this.n32*a.n23+this.n33*a.n33+this.n34*a.n43;b.n34=this.n31*a.n14+this.n32*a.n24+this.n33*a.n34+this.n34*a.n44;b.n41=this.n41*a.n11+this.n42*a.n21+this.n43*a.n31+this.n44*a.n41;b.n42=this.n41*a.n12+this.n42*a.n22+this.n43*a.n32+this.n44*a.n42;b.n43=this.n41*a.n13+this.n42*a.n23+this.n43*a.n33+this.n44*a.n43;b.n44=this.n41*a.n14+this.n42*a.n24+this.n43*a.n34+this.n44*a.n44;this.initialize(b)};this.initialize=function(a){for(var b in a)this[b]=a[b]};this.createBox=function(a,b,c,d,e,k,f,g,h){this.identity();0!=d&&this.rotateX(d);0!=e&&this.rotateY(e);0!=k&&this.rotateZ(k);1==a&&1==b&&1==c||this.scale(a,b,c);0==f&&0==g&&0==h||this.translate(f,g,h)};this.identity=function(){this.initialize({n11:1,n12:0,n13:0,n14:0,n21:0,n22:1,n23:0,n24:0,n31:0,n32:0,n33:1,n34:0,n41:0,n42:0,n43:0,n44:1})};this.rotateX=function(a){var b=Math.sin(a);a=Math.cos(a);this.concat(new Matrix3D(1,0,0,0,0,a,-b,0,0,b,a,0,0,0,0,1))};this.rotateY=function(a){var b=Math.sin(a);a=Math.cos(a);this.concat(new Matrix3D(a,0,b,0,0,1,0,0,-b,0,a,0,0,0,0,1))};this.rotateZ=function(a){var b=Math.sin(a);a=Math.cos(a);this.concat(new Matrix3D(a,-b,0,0,b,a,0,0,0,0,1,0,0,0,0,1))};this.setRotateAxis=function(a,b){var c=Math.cos(b),d=Math.sin(b),e=1-c,k=a.x(),f=a.y(),g=a.z(),h=e*k,n=e*f;this.concat(h*k+c,h*f-d*g,h*g+d*f,0,h*f+d*g,n*f+c,n*g-d*k,0,h*g-d*f,n*g+d*k,e*g*g+c,0,0,0,0,1)};this.scale=function(a,b,c){this.concat(new Matrix3D(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1))};this.translate=function(a,b,c){this.n41+=a;this.n42+=b;this.n43+=c};this.transformPoint=function(a){return new Vertex3D(this.n11*a.x+this.n21*a.y+this.n31*a.z+this.n41,this.n12*a.x+this.n22*a.y+this.n32*a.z+this.n42,this.n13*a.x+this.n23*a.y+this.n33*a.z+this.n43)};this.transformArray=function(a){for(var b=[],c=a.length/3,d=0;c>d;d++){var e=3*d,k=a[e],f=a[e+1],g=a[e+2];b[e]=this.n11*k+this.n21*f+this.n31*g+this.n41;b[e+1]=this.n12*k+this.n22*f+this.n32*g+this.n42;b[e+2]=this.n13*k+this.n23*f+this.n33*g+this.n43}return b};this.getPosition=function(){return[this.n12,this.n13,this.n14]};this.setPosition=function(a){return this.n12=a.x,this.n13=a.y,this.n14=a.z,this};this.makeFrustum=function(a,b,c,d,e,k){var f={};f.n11=2*e/(b-a);f.n12=0;f.n13=(b+a)/(b-a);f.n14=0;f.n21=0;f.n22=2*e/(d-c);f.n23=(d+c)/(d-c);f.n24=0;f.n31=0;f.n32=0;f.n33=-(k+e)/(k-e);f.n34=-2*k*e/(k-e);f.n41=0;f.n42=0;f.n43=-1;f.n44=0;this.concat(f)};this.makePerspective=function(a,b,c,d){a=c*Math.tan(a*Math.PI/360);var e=-a;this.makeFrustum(e*b,a*b,e,a,c,d)};this.makeOrtho=function(a,b,c,d,e,f){var k={},g=b-a,h=c-d,n=f-e;k.n11=2/g;k.n12=0;k.n13=0;k.n14=-((b+a)/g);k.n21=0;k.n22=2/h;k.n23=0;k.n24=-((c+d)/h);k.n31=0;k.n32=0;k.n33=-2/n;k.n34=-((f+e)/n);k.n41=0;k.n42=0;k.n43=0;k.n44=1;this.concat(k)};this.toString=function(){return this.n11+","+this.n12+","+this.n13+","+this.n14+","+this.n21+","+this.n22+","+this.n23+","+this.n24+","+this.n31+","+this.n32+","+this.n33+","+this.n34+","+this.n41+","+this.n42+","+this.n43+","+this.n44}};folio.F3D={FScene3:{},FPoint3:{},FSize3:{},FPath3:function(){}};folio.F3D.FPath3=Path.extend({_class:"FPath3",_serializeFields:{segments:[],closed:!1,scene:null,matrix:null,size:null,position3:null,fpoints3:[],rotation:null,translation:null},initialize:function(a){this._closed=!1;this._segments=[];this._scene=a;this._matrix=new Matrix3D;this._size=new folio.F3D.FSize3;this._position3=new folio.F3D.FPoint3;this._fpoints3=[];this._rotation=new folio.F3D.FPoint3;this._translation=new folio.F3D.FPoint3;this.name="FPath3";Path.call(this);this._initialize()},setScene:function(a){this._scene=a;for(a=0;a<this._fpoints3.length;a++)this._fpoints3[a].setup(this._scene)},add3:function(a){this._fpoints3[this._fpoints3.length]=a},translate:function(a,b,c){"number"==typeof a?(this._translation.x=a,this._translation.y=b,this._translation.z=c):"object"==typeof a?(this._translation.x=a.x,this._translation.y=a.y,this._translation.z=a.z):(this._translation.x=void 0!=a?a:0,this._translation.y=void 0!=b?b:0,this._translation.z=void 0!=c?c:0);for(a=0;a<this._fpoints3.length;a++)b=this._fpoints3[a],b.setX(b.x+this._translation.x),b.setY(b.y+this._translation.y),b.setZ(b.z+this._translation.z)},rotateX:function(a){this._rotation.x=a},rotateY:function(a){this._rotation.y=a},rotateZ:function(a){this._rotation.z=a},get:function(){this._segments=[];for(var a=0;a<this._fpoints3.length;a++){var b=this._fpoints3[a];this.add(new Point(b.x2D(),b.y2D()))}return this}});folio.F3D.FPath3.inject({statics:new function(){return{FBox:function(a,b,c){this._position3=void 0!=b?b:new folio.F3D.FPoint3(0,0,0);this._size=void 0!=c?c:new folio.F3D.FSize3(10,10,10);c=[6];for(var d=[new folio.F3D.FPoint3(-0.5,-0.5,-0.5),new folio.F3D.FPoint3(0.5,-0.5,-0.5),new folio.F3D.FPoint3(0.5,0.5,-0.5),new folio.F3D.FPoint3(-0.5,0.5,-0.5)],e=[new folio.F3D.FPoint3(-0.5,-0.5,0.5),new folio.F3D.FPoint3(0.5,-0.5,0.5),new folio.F3D.FPoint3(0.5,-0.5,-0.5),new folio.F3D.FPoint3(-0.5,-0.5,-0.5)],f=[new folio.F3D.FPoint3(-0.5,0.5,0.5),new folio.F3D.FPoint3(0.5,0.5,0.5),new folio.F3D.FPoint3(0.5,0.5,-0.5),new folio.F3D.FPoint3(-0.5,0.5,-0.5)],g=[new folio.F3D.FPoint3(-0.5,-0.5,-0.5),new folio.F3D.FPoint3(-0.5,-0.5,0.5),new folio.F3D.FPoint3(-0.5,0.5,0.5),new folio.F3D.FPoint3(-0.5,0.5,-0.5)],h=[new folio.F3D.FPoint3(0.5,-0.5,-0.5),new folio.F3D.FPoint3(0.5,-0.5,0.5),new folio.F3D.FPoint3(0.5,0.5,0.5),new folio.F3D.FPoint3(0.5,0.5,-0.5)],l=[new folio.F3D.FPoint3(-0.5,-0.5,0.5),new folio.F3D.FPoint3(0.5,-0.5,0.5),new folio.F3D.FPoint3(0.5,0.5,0.5),new folio.F3D.FPoint3(-0.5,0.5,0.5)],d=[["front",d],["top",e],["bottom",f],["left",g],["right",h],["back",l]],e=[],f=0;f<d.length;f++){c[f]=new folio.F3D.FPath3;c[f].name="Z-TOP";e=d[f][1];for(g=0;g<e.length;g++)c[f].add3(new folio.F3D.FPoint3(e[g].x*this._size.width,e[g].y*this._size.height,e[g].z*this._size.depth));c[f].closed=!0;c[f].translate(b);a.addItem(c[f])}return new Group(c)},FSphere:function(a,b,c,d){this._position3=void 0!=b?b:new folio.F3D.FPoint3(0,0,0);this._size=void 0!=c?new folio.F3D.FSize3(c,c,c):new folio.F3D.FSize3(10,10,10);var e;e=void 0!=d?d instanceof Array?d:[d,d]:[6,6];c=[];for(d=0;d<=e[0];d++)for(var f=Math.PI*(-0.5+(d-1)/e[0]),g=Math.sin(f),f=Math.cos(f),h=Math.PI*(-0.5+d/e[0]),l=Math.sin(h),h=Math.cos(h),k=0;k<=e[1];k++){var n=(k-1)/e[1]*Math.PI*2,m=Math.cos(n),n=Math.sin(n);c.push(new folio.F3D.FPoint3(m*f,n*f,g));c.push(new folio.F3D.FPoint3(m*h,n*h,l))}e=[c.length-2];for(d=0;d<c.length-2;d++)e[d]=new folio.F3D.FPath3,e[d].name="face"+d,e[d].add3(new folio.F3D.FPoint3(0.5*c[d].x*this._size.width,0.5*c[d].y*this._size.height,0.5*c[d].z*this._size.depth)),e[d].add3(new folio.F3D.FPoint3(0.5*c[d+1].x*this._size.width,0.5*c[d+1].y*this._size.height,0.5*c[d+1].z*this._size.depth)),e[d].add3(new folio.F3D.FPoint3(0.5*c[d+2].x*this._size.width,0.5*c[d+2].y*this._size.height,0.5*c[d+2].z*this._size.depth)),e[d].closed=!0,e[d].translate(b),a.addItem(e[d]);return new Group(e)}}}});folio.F3D.FPoint3=this.FPoint3=function(a,b,c){var d=null,e=0,f=0,g=0,h=0,l=0;this.x=void 0!=a?a:0;this.y=void 0!=b?b:0;this.z=void 0!=c?c:0;this.setup=function(a){d=a;var b=d.setupPoint(this.x,this.y,this.z);a=3*b;b*=2;e=a;f=a+1;g=a+2;h=b;l=b+1};this.random=function(a,b,c,d,e,f){return a=void 0!=a?a:0,b=void 0!=b?b:view.bounds.width,c=void 0!=c?c:0,d=void 0!=d?d:view.bounds.height,e=void 0!=e?c:0,f=void 0!=f?d:1E3,this.x=paper.random(a,b),this.y=paper.random(c,d),this.z=paper.random(e,f),new folio.F3D.FPoint3(this.x,this.y,this.z)};this.setX=function(a){null!=d&&(d.points3D[e]=a);this.x=a};this.setY=function(a){null!=d&&(d.points3D[f]=a);this.y=a};this.setZ=function(a){null!=d&&(d.points3D[g]=a);this.z=a};this.set=function(a,b,c){this.setX(a);this.setY(b);this.setZ(c)};this.get=function(){return new folio.F3D.FPoint3(this.x,this.y,this.z)};this.x2D=function(){return d.points2D[h]};this.y2D=function(){return d.points2D[l]};this.getSceneIndex=function(){return _sceneIndex};this.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};this.add=function(a,b,c){"number"==typeof a?(this.x+=a,this.y+=b,this.z+=c):"object"==typeof a&&(this.x+=a.x(),this.y+=a.y(),this.z+=a.z());this.set(this.x,this.y,this.z)};this.sub=function(a,b,c){"number"==typeof a?(this.x-=a,this.y-=b,this.z-=c):"object"==typeof a&&(this.x-=a.x(),this.y-=a.y(),this.z-=a.z());this.set(this.x,this.y,this.z)};this.scale=function(a){this.x*=a;this.y*=a;this.z*=a;this.set(this.x,this.y,this.z)};this.mult=function(a,b,c){"number"==typeof a?(this.x*=a,this.y*=b,this.z*=c):"object"==typeof a&&(this.x*=a.x(),this.y*=a.y(),this.z*=a.z());this.set(this.x,this.y,this.z)};this.div=function(a,b,c){"number"==typeof a?(this.x/=a,this.y/=b,this.z/=c):"object"==typeof a&&(this.x/=a.x(),this.y/=a.y(),this.z/=a.z());this.set(this.x,this.y,this.z)};this.getDistance=function(a){var b=this.x-a.x(),c=this.y-a.y();a=this.z-a.z();return Math.sqrt(b*b+c*c+a*a)};this.angleBetween=function(a,b){var c=a.x()*b.x()+a.y()*b.y()+a.z()*b.z(),d=Math.sqrt(a.x()*a.x()+a.y()*a.y()+a.z()*a.z()),e=Math.sqrt(b.x()*b.x()+b.y()*b.y()+b.z()*b.z());return Math.acos(c/(d*e))};this.normalize=function(){var a=this.mag();0!=a&&1!=a&&this.div(a)};this.toString=function(){return"[ "+this.x+", "+this.y+", "+this.z+" ]"};this.array=function(){return[this.x,this.y,this.z]}};folio.F3D.FScene3D=this.FScene3D=function(){function a(a,b){return a.z<b.z?-1:a.z>b.z?1:0}var b="PERSPECTIVE",c=null,d=new folio.F3D.FSize3(0,0,0),e=new folio.F3D.FPoint3(0,0,0),f=0,g=null,h=null,l=null;this.bounds=new folio.F3D.FSize3(0,0,0);this.points3D=[];this.points2D=[];this._ortho=function(){c.makeOrtho(-d.height,d.height,d.height,-d.height,-d.height,d.height)};this._perspective=function(){c.makePerspective(50,0.5*this.bounds.width/this.bounds.height,d.depth,2*this.bounds.depth)};this.setup=function(a,b,e,f){this.points3D=[];this.points2D=[];g=[];c=new Matrix3D;this.bounds.width=a||paper.view.bounds.width;this.bounds.height=b||paper.view.bounds.height;this.bounds.depth=e||1E3;d.width=0.5*this.bounds.width;d.height=0.5*this.bounds.height;d.depth=0.5*this.bounds.depth;this.setMode(f);h=new Group;l=new Group};this.draw=function(){c.identity();"ORTHO"==b?this._ortho():this._perspective();c.scale(1,1,1);c.rotateX(e.x);c.rotateY(e.y);c.rotateZ(e.z);c.translate(0,0,this.bounds.depth);for(var k=c.transformArray(this.points3D),n=0;f>n;n++){var m=3*n,r=2*n,s=k[m+1],t=this.bounds.depth/(k[m+2]+this.bounds.depth);this.points2D[r]=k[m]*t+d.width;this.points2D[r+1]=s*t+d.height}r=0;m=[];for(n=0;n<g.length;n++)s=g[n],t=this.averageZ(k,r,r+3*s._fpoints3.length),m.push({index:n,z:t}),r+=3*s._fpoints3.length-1;m.sort(a);h.removeChildren();l.removeChildren();for(n=0;n<m.length;n++)k=g[m[n].index].get(),"Z-TOP"==k.name?l.appendTop(k):"Z-BOTTOM"==k.name?h.appendTop(k):null!=k&&h.appendTop(k);return"ORTHO"==b&&(l.scale(200,h.position),h.scale(200,h.position)),new Group(h,l)};this.setupPoint=function(a,b,c){var d=f;return this.points2D[this.points2D.length]=0,this.points2D[this.points2D.length]=0,this.points3D[this.points3D.length]=a,this.points3D[this.points3D.length]=b,this.points3D[this.points3D.length]=c,f++,d};this.averageZ=function(a,b,c){for(var d=0,e=b;c>e;e+=2)d+=parseInt(a[e+2]);return d/((c-b)/3)};this.setMode=function(a){b=void 0!=a?a:"PERSPECTIVE"};this.addItem=function(a){if(0<a.length)for(var b=0;b<a.length;b++)g[g.length]=a[b],a[b].setScene(this);else g[g.length]=a,a.setScene(this)};this.rotateX=function(a){e.setX(a)};this.rotateY=function(a){e.setY(a)};this.rotateZ=function(a){e.setZ(a)};this.get=function(){return h};this.getBounds=function(){return[this.bounds.width,this.bounds.height,this.bounds.depth]};this.getMatrix=function(){return c};this.getFocalLength=function(){return this.bounds.depth};this.getScale=function(){return 1}};folio.F3D.FSize3=this.FSize3=function(a,b,c){this.width=void 0!=a?a:0;this.height=void 0!=b?b:0;this.depth=void 0!=c?c:0;this.setWidth=function(a){this.width=a};this.setHeight=function(a){this.height=a};this.setDepth=function(a){this.depth=a};this.set=function(a,b,c){this.setWidth(a);this.setHeight(b);this.setDepth(c)};this.get=function(){return new folio.F3D.FSize3(this.width,this.height,this.depth)};this.random=function(a,b,c,g,h,l){return a=void 0!=a?a:0,b=void 0!=b?b:view.bounds.width,c=void 0!=c?c:0,g=void 0!=g?g:view.bounds.height,h=void 0!=h?h:0,l=void 0!=l?l:1E3,this.width=paper.random(a,b),this.height=paper.random(c,g),this.depth=paper.random(h,l),this};this.volume=function(){return this.width*this.height*this.depth}};