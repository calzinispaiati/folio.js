var frederickkPaper=frederickkPaper||{};(function(){console.log("\nfrederickkPaper.js");console.log("v.0.1a");console.log("https://github.com/frederickk/frederickkPaper");console.log("ken.frederick@gmx.de");console.log("------------------------------------\n")})();frederickkPaper={FIO:{},F3D:{},FShape:{},FTime:{},random:function(b,a){if(a===undefined){a=b;b=0}return(b+Math.random()*(a-b))},randomInt:function(b,a){return parseInt(frederickkPaper.random(b,a))},randomBias:function(e,d,a){var g=new Array(90,9,4,2.33,1.5,1,0.66,0.43,0.25,0.11,0.01);a=Math.max(0,Math.min(a,1))*10;var b=parseInt(Math.floor(a));var h=g[b];if(a<10){h+=(g[b+1]-h)*(a-b)}return Math.pow(Math.random(),h)*(d-e)+e},clamp:function(d,b,a){return d<b?b:d>a?b:d},norm:function(b,d,a){return(b-d)/(a-d)},map:function(e,b,d,a,g){return a+(g-a)*((e-b)/(d-b))},roundDecimal:function(d,a){var b=Math.pow(10,a);return Math.round(d*b)/b},snap:function(b,a,d){if(d===undefined){d=Math.round}return a*d(b/a)},lerp:function(d,a,b){return a+(d-a)*b},degrees:function(a){return a*(180/Math.PI)},radians:function(a){return a*(Math.PI/180)},getAngle:function(b,a){return Math.atan2(a.y-b.y,a.x-b.x)*180/Math.PI},getCommonTangents:function(h,e){var o=e.position.x-h.position.x;var n=e.position.y-h.position.y;var b=Math.sqrt(h.bounds.size.area());var a=Math.sqrt(e.bounds.size.area());b/=2;a/=2;var i=h.position.getDistance(e.position);if(i<=Math.abs(a-b)){return}var g=Math.atan2(n,o);var d=Math.acos((b-a)/i);var m=new Point(h.position.x+b*Math.cos(g+d),h.position.y+b*Math.sin(g+d));var l=new Point(e.position.x+a*Math.cos(g+d),e.position.y+a*Math.sin(g+d));var j=new Point(h.position.x+b*Math.cos(g-d),h.position.y+b*Math.sin(g-d));var k=new Point(e.position.x+a*Math.cos(g-d),e.position.y+a*Math.sin(g-d));return[m,l,k,j]},sq:function(a){return a*a},boolToInt:function(a){return(a)?1:0},getType:function(a){if(a instanceof paper.Point){return"Point"}else{if(a instanceof paper.Size){return"Size"}else{if(a instanceof paper.Rectangle){return"Rectangle"}else{if(a instanceof paper.Group){return"Group"}else{if(a instanceof paper.PlacedItem){return"PlacedItem"}else{if(a instanceof paper.Raster){return"Raster"}else{if(a instanceof paper.PlacedSymbol){return"PlacedSymbol"}else{if(a instanceof paper.Path){return"Path"}else{if(a instanceof paper.CompoundPath){return"CompoundPath"}else{if(a instanceof paper.Symbol){return"Symbol"}else{if(a instanceof paper.TextItem){return"TextItem"}else{return"undefined"}}}}}}}}}}}},findByName:function(a,b){var g;for(var d=0;d<a.length;d++){var e=a[d];if(e.name==b){g=e}}return g},trimToFit:function(a){var b=a.visibleRange.content;a.content=trim(b);return a},rtrim:function(b){for(var a=b.length-1;b.charAt(a)==" ";a--){b=b.substring(0,a)}return b},trim:function(a){a=a.replace(/(^\s*)|(\s*$)/gi,"");a=a.replace(/[ ]{2,}/gi," ");a=a.replace(/\n /,"\n");return a},strToBool:function(a){switch(a.toLowerCase()){case"true":case"yes":case"1":return true;case"false":case"no":case"0":case null:return false;default:return Boolean(a)}},merge:function(d,b){var a=d.concat(b);a.shuffle();return a},alphabetical:function(e,d){e=e.toLowerCase();e=e.replace(/ä/g,"a");e=e.replace(/ö/g,"o");e=e.replace(/ü/g,"u");e=e.replace(/ß/g,"s");d=d.toLowerCase();d=d.replace(/ä/g,"a");d=d.replace(/ö/g,"o");d=d.replace(/ü/g,"u");d=d.replace(/ß/g,"s");return(e==d)?0:(e>d)?1:-1},distanceToCenter:function(e,d){var i=e.distanceToCenter();var h=d.distanceToCenter();var g=0;if(i>h){g=-1}else{if(i<h){g=1}}return g}};Array.prototype.max=function(){var b=this[0];var a=this.length;for(var d=1;d<a;d++){if(this[d]>b){b=d}}return b};Array.prototype.min=function(){var d=this[0];var a=this.length;for(var b=1;b<a;b++){if(this[b]<d){d=b}}return d};Array.prototype.shuffle=function(){for(var b,a,d=this.length;d;b=parseInt(Math.random()*d),a=this[--d],this[d]=this[b],this[b]=a){}};paper.Item.inject({distanceToCenter:function(){var b=this.position.x-activeDocument.activeArtboard.bounds.center.x;var a=this.position.y-activeDocument.activeArtboard.bounds.center.y;var d=(b*b+a*a)+1;return d},getRadius:function(){return this.size.radius()},snapGrid:function(b){var a=new frederickkPaper.FPoint().snapGrid(b);this.position=a},snapIso:function(b){var a=new frederickkPaper.FPoint().snapIso(b);this.position=a}});paper.Size.inject({random:function(a,e,d,b){a=(a!=undefined)?a:0;e=(e!=undefined)?e:view.bounds.width;d=(d!=undefined)?d:0;b=(b!=undefined)?b:view.bounds.height;this.width=frederickkPaper.random(a,e);this.height=frederickkPaper.random(d,b);return this},area:function(){return(this.width*this.height)},radius:function(){var e=this.width;var d=this.height;return(Math.sqrt(e*e+d*d)/2)}});paper.Point.inject({});frederickkPaper.FColor=function(){var a=function(b){var d=c.toString(16);return d.length==1?"0"+d:d};this.lerpRGBColor=function(i,h,l){var k=frederickkPaper.lerp(i.red,h.red,l);var j=frederickkPaper.lerp(i.green,h.green,l);var d=frederickkPaper.lerp(i.blue,h.blue,l);var e=new paper.RGBColor(k,j,d);return e};this.randomRGBColor=function(){return new paper.RGBColor(Math.random(),Math.random(),Math.random())};this.randomCMYKColor=function(){return new paper.CMYKColor(Math.random(),Math.random(),Math.random(),Math.random())};this.randomGrayColor=function(){return new paper.GrayColor(Math.random())};this.random=function(){return this.randomRGBColor()};this.ColorToInt=function(d){var b;try{b=d.red;b=b<<8;b|=d.green;b=b<<8;b|=d.blue}catch(e){console.log(e);b=16777215}return b};this.IntToColor=function(i){var h=(RGB>>16)&255;var e=(RGB>>8)&255;var d=RGB&255;return new paper.RGBColor((h/255),(e/255),(d/255))};this.ColorToHex=function(e){var j,i,d;var k="";try{j=e.red*255;i=e.green*255;d=e.blue*255;k="#"+a(j)+a(i)+a(d)}catch(h){console.log(h)}return k};this.HexToColor=function(j){if(j.length>=7){hex=j.split("#")[1]}else{hex=j}var e=parseInt(hex,16);var i=(e>>16)&255;var h=(e>>8)&255;var d=e&255;return new paper.RGBColor(i/255,h/255,d/255)};this.ByteToColor=function(j,i,m,h){var l=j/255;var k=i/255;var d=m/255;var e=(h!=undefined)?h/255:1;return new paper.RGBColor(l,k,d,e)}};paper.Color.inject({darken:function(a){this.red-=a;this.green-=a;this.blue-=a;return this},lighten:function(a){this.red+=a;this.green+=a;this.blue+=a;return this}});frederickkPaper.FConversions=function(){this.ptToMm=0.352777778;this.mmToPt=2.83464567;this.ptToCm=0.0352777778;this.CmToPt=28.3464567;this.ptToIn=0.0138888889;this.inToPt=72;this.ptToPi=0.0833333333;this.piToPt=12};frederickkPaper.FPoint=paper.Point.extend({norm:function(a,b){this.x=frederickkPaper.norm(this.x,start.x,stop.x);this.y=frederickkPaper.norm(this.y,start.y,stop.y);return this},random:function(b,e,a,d){b=(b!=undefined)?b:0;e=(e!=undefined)?e:view.bounds.width;a=(a!=undefined)?a:0;d=(d!=undefined)?d:view.bounds.height;this.x=frederickkPaper.random(b,e);this.y=frederickkPaper.random(a,d);return this},heading:function(){return -1*(Math.atan2(-this.y,this.x))},interpolateTo:function(b,a){this.x+=((b.x-this.x)*a);this.y+=((b.y-this.y)*a);return this},lerp:function(d,b,g){var a=frederickkPaper.lerp(d.x,b.x,g);var e=frederickkPaper.lerp(d.y,b.y,g);return new Point(a,e)},limit:function(a){if(this.magSq()>a*a){this.normalize();this.mult*a;return this}return this},magSq:function(){return this.x*this.x+this.y*this.y},snapGrid:function(d){var b,a;b=Math.round(this.y/d.height-this.x/d.width);a=Math.round(this.y/d.height+this.x/d.width);this.x=(a-b)/2*d.width;this.y=(a+b)/2*d.height;return this},snapIso:function(a){if(a===null){a=1}return this.snapGrid(new Size(32*a,16*a))},getAngle:function(){return Math.atan2(this.y-0,this.x-0)}});frederickkPaper.FIO={saveLocal:function(a,b){if(window.localStorage){localStorage.setItem(a,String(b))}else{console.error("localStorage not supported")}},getLocal:function(a){return localStorage.getItem(a)},getLocalInt:function(a){return parseInt(getLocal(a))},getLocalFloat:function(a){return parseFloat(getLocal(a))},getAllLocal:function(){return sessionStorage},deleteLocal:function(a){localStorage.removeItem(a)},saveSession:function(a,b){if(window.sessionStorage){sessionStorage.setItem(a,String(b))}else{console.error("sessionStorage not supported")}},getSession:function(a){return sessionStorage.getItem(a)},getSessionInt:function(a){return parseInt(getSession(a))},getSessionFloat:function(a){return parseFloat(getSession(a))},getAllSession:function(){return sessionStorage},deleteSession:function(a){sessionStorage.removeItem(a)},saveCookie:function(d,e,g){if(g){var b=new Date();b.setTime(b.getTime()+(g*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}document.cookie=d+"="+e+a+"; path=/"},openCookie:function(b){var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var g=a[d];while(g.charAt(0)==" "){g=g.substring(1,g.length)}if(g.indexOf(e)==0){return g.substring(e.length,g.length)}}return null},deleteCookie:function(a){saveCookie(a,"",-1)}};frederickkPaper.FTime.FDate=function(){this.date;var a=["January","February","March","April","May","June","July","August","September","October","November","December"];var b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var d=function(e){if(e.length==1){e="0"+e}return e};this.year=function(){if(this.date===undefined){this.date=new Date()}var e=String(this.date.getFullYear());return e};this.month=function(){if(this.date===undefined){this.date=new Date()}var e=String(this.date.getMonth());hour=d(e);return e};this.day=function(){if(this.date===undefined){this.date=new Date()}var e=String(this.date.getDate());return e};this.hour=function(){if(this.date===undefined){this.date=new Date()}var e=String(this.date.getHours());e=d(e);return e};this.minute=function(){if(this.date===undefined){this.date=new Date()}var e=String(this.date.getMinutes());e=d(e);return e};this.second=function(){if(this.date===undefined){this.date=new Date()}var e=String(this.date.getSeconds());e=d(e);return e};this.now=function(g){var e=[];if(g===undefined){e=[true,true,true]}else{e=g}var h="";if(e[0]){h+=this.hour()}if(e[0]&&e[1]){h+=":"}if(e[1]){h+=this.minute()}if(e[1]&&e[2]){h+=":"}if(e[2]){h+=this.second()}return h};this.nowMilliseconds=function(){return this.toMillsecond(this.hour(),this.minute(),this.second())};this.add=function(e,i,g,h){return this.date+(24*e+60*i+60*g+1000*s)};this.sub=function(e,i,g,h){return this.date-(24*e+60*i+60*g+1000*s)};this.set=function(e,i,g,h){this.time=new Date();this.time.setTime((24*e+60*i+60*g+1000*s));return this.time};this.get=function(e,m){var n;if(m===undefined){n=new Array(true,true,true)}else{n=m}var l=parseInt((e/1000)%60);var i=parseInt(((e/1000)/60)%60);var k=parseInt((((e/1000)/60)/60)%24);var g,h,o;if(k<10){g="0"+k}else{g=""+k}if(i<10){h="0"+i}else{h=""+i}if(l<10){o="0"+l}else{o=""+l}var j="";if(n[0]){j+=g}if(n[0]&&n[1]){j+=":"}if(n[1]){j+=h}if(n[1]&&n[2]){j+=":"}if(n[2]){j+=o}return j};this.toMillsecond=function(l,g,k){var j,e,i;if(g===undefined&&k===undefined){j=this.toArray(l)[0];e=this.toArray(l)[1];i=this.toArray(l)[2]}else{j=l;e=g;i=k}return parseInt(3600000*j+60000*e+1000*i)};this.toArray=function(e){var g=e.split(":");return[g[0],g[1],g[2]]}};frederickkPaper.FTime.FStepper=function(){var e=1000;var g=0;var j=0;var l=0;var i=false;var a=false;var k=false;var d=true;var h=0.05;var b=true;this.delta=1;this.counter=-1;this.toggle=function(){if(l==0){l=1;this.stepOut()}else{l=0;this.stepIn()}};this.update=function(m){if(i){i=false;g=m;if(a){j=frederickkPaper.roundDecimal((m+((1-this.delta)*e)),3)}else{j=frederickkPaper.roundDecimal((m+(this.delta*e)),3)}if(j<=m){if(a){a=false;this.delta=1}else{k=false;this.delta=0}}}if(a){this.delta=frederickkPaper.roundDecimal((1-((j-m)/e)),3);if(m==j){a=false;this.delta=1;this.counter++;return}}else{if(k){this.delta=frederickkPaper.roundDecimal(((j-m)/e),3);if(m==j){a=false;this.delta=0;this.counter++;return}}}};this.stepIn=function(){if(a){return}if(this.delta==1){return}i=true;a=true;k=false};this.stepOut=function(){if(k){return}if(this.delta==0){return}i=true;k=true;a=false};this.isIn=function(){return a};this.isOut=function(){return k};this.isDone=function(){if(this.delta<1&&this.delta>0){return false}else{if(this.delta>=1){this.delta=1;return true}else{if(this.delta<=0){this.delta=0;return true}}}};this.stop=function(){i=a=k=false};this.setSeconds=function(m){this.setMillis(parseInt(m*1000))};this.setMillis=function(m){e=m;e/=1000};this.setDelta=function(m){this.delta=m}};frederickkPaper.FTime.FStopwatch=function(){var b;var e;var a=0;var d=0;this.toggle=function(){if(d==0){this.start()}else{this.pause()}};this.start=function(){d=1;e=new Date();e.setTime(e.getTime()-a)};this.pause=function(){d=0;b=new Date();a=b.getTime()-e.getTime()};this.reset=function(){d=0;a=0};this.set=function(g,h){a=g;(h==true)?d=0:d=1;e=new Date();e.setTime(e.getTime()-a);this.toggle()};this.get=function(){if(d==1){b=new Date();a=b.getTime()-e.getTime()}return a};this.isRunning=function(){return(d)?true:false}};frederickkPaper.F3D.FPath3=function(j){this.path=new Path();this.name="";this.closed=false;this.opacity=1;this.blendMode="normal";this.visible=true;this.selected=false;this.fillColor;this.strokeColor;this.strokeWidth=1;this.strokeCap;this.strokeJoin;this.rotation=new frederickkPaper.F3D.FPoint3();this.translation=new frederickkPaper.F3D.FPoint3();var b=j;var l=[];var k=new Matrix3D();var i=0;var h=0;var g=0;var e=0;var d=0;var a=0;this.draw=function(){this.path.remove();this.path=new Path();this.path.name=this.name;for(var m=0;m<l.length;m++){var n=l[m];this.path.add(new Point(n.x2D(),n.y2D()))}this.path.opacity=this.opacity;this.path.blendMode=this.blendMode;this.path.visible=this.visible;this.path.selected=this.selected;this.path.fillColor=this.fillColor;this.path.strokeColor=this.strokeColor;this.path.strokeWidth=this.strokeWidth;this.path.strokeCap=this.strokeCap;this.path.strokeJoin=this.strokeJoin;this.path.closed=this.closed;return this.path};this.addToScene=function(m){console.log("path3.addToScene");for(var n=0;n<l.length;n++){l[n].setup(m)}};this.add=function(m){l[l.length]=m};this.translate=function(o,n,m){e=o!=undefined?o:0;d=n!=undefined?n:0;a=m!=undefined?m:0;for(var p=0;p<l.length;p++){var q=l[p];q.setX((q.x()+e));q.setY((q.y()+d));q.setZ((q.z()+a))}};this.rotateX=function(m){i=m};this.rotateY=function(m){h=m};this.rotateZ=function(m){g=m};this.get=function(){return this.path}};frederickkPaper.F3D.FPoint3=function(m,j,h){var n=m!=undefined?m:0;var l=j!=undefined?j:0;var i=h!=undefined?h:0;var e=null;var a=0;var d=0;var k=0;var g=0;var b=0;this.setup=function(p){console.log("fpoint.setup");e=p;var o=e.setupPoint(n,l,i);var q=o*3;var r=o*2;a=q;d=q+1;k=q+2;g=r;b=r+1};this.setX=function(o){if(e!=null){e.points3D[a]=o}n=o};this.setY=function(o){if(e!=null){e.points3D[d]=o}l=o};this.setZ=function(o){if(e!=null){e.points3D[k]=o}i=o};this.set=function(q,p,o){this.setX(q);this.setY(p);this.setZ(o)};this.get=function(){return new frederickkPaper.F3D.FPoint3(n,l,i)};this.x=function(){return n};this.y=function(){return l};this.z=function(){return i};this.x2D=function(){return e.points2D[g]};this.y2D=function(){return e.points2D[b]};this.getSceneIndex=function(){return sceneIndex};this.mag=function(){return Math.sqrt(n*n+l*l+i*i)};this.add=function(o){n+=o.x();l+=o.y();i+=o.z();this.set(n,l,i)};this.add=function(q,p,o){n+=q;l+=p;i+=o;this.set(n,l,i)};this.sub=function(o){n-=o.x();l-=o.y();i-=o.z();this.set(n,l,i)};this.sub=function(q,p,o){n-=q;l-=p;i-=o;this.set(n,l,i)};this.scale=function(o){n*=o;l*=o;i*=o;this.set(n,l,i)};this.mult=function(o){n*=o.x();l*=o.y();i*=o.z();this.set(n,l,i)};this.mult=function(q,p,o){n*=q;l*=p;i*=o};this.div=function(o){n/=o.x();l/=o.y();i/=o.z();this.set(n,l,i)};this.div=function(q,p,o){n/=q;l/=p;i/=o;this.set(n,l,i)};this.getDistance=function(r){var q=n-r.x();var p=l-r.y();var o=i-r.z();return Math.sqrt(q*q+p*p+o*o)};this.angleBetween=function(t,r){var p=t.x()*r.x()+t.y()*r.y()+t.z()*r.z();var q=Math.sqrt(t.x()*t.x()+t.y()*t.y()+t.z()*t.z());var o=Math.sqrt(r.x()*r.x()+r.y()*r.y()+r.z()*r.z());return Math.acos(p/(q*o))};this.normalize=function(){var o=this.mag();if(o!=0&&o!=1){this.div(o)}};this.toString=function(){return"[ "+n+", "+l+", "+i+" ]"};this.array=function(){return[n,l,i]}};frederickkPaper.F3D.FScene3D=function(){var r;var h;var p=new Matrix3D();var g;var n;var m=0;var k=0;var j=0;var i=1;var b=0;var e=0;var d=0;var o=0;var l=[];this.points3D=[];this.points2D=[];this.setup=function(t,v,u,w){b=u||1000;e=t||paper.view.bounds.width;d=v||paper.view.bounds.height;g=e*0.5;n=d*0.5;h=w!=undefined?w:"PERSPECTIVE";this.setMode(h);r=new paper.Group()};this.draw=function(){p.identity();if(h=="ORTHO"){q()}else{a()}p.scale(i,i,i);p.rotateX(m);p.rotateY(k);p.rotateZ(j);p.translate(0,0,b);var w=p.transformArray(this.points3D);for(var A=0;A<o;A++){var t=A*3;var v=A*2;var D=w[t];var C=w[t+1];var B=w[t+2];var u=b/(B+b);this.points2D[v]=D*u+g;this.points2D[v+1]=C*u+n}console.log("items.length\t"+l.length);r.removeChildren();for(var A=0;A<l.length;A++){var E=l[A].draw();if(E!=null){r.appendTop(E)}}if(h=="ORTHO"){r.scale(200)}return r};this.setupPoint=function(t,w,v){var u=o;this.points2D[this.points2D.length]=0;this.points2D[this.points2D.length]=0;this.points3D[this.points3D.length]=t;this.points3D[this.points3D.length]=w;this.points3D[this.points3D.length]=v;o++;return u};var q=function(){p.makeOrtho(-n,n,n,-n,-n,n)};var a=function(){p.makePerspective(50,1,b,b*2)};this.setMode=function(t){h=t};this.addItem=function(t){console.log("scene.addItem");l[l.length]=t;t.addToScene(this)};this.rotateX=function(t){m=t};this.rotateY=function(t){k=t};this.rotateZ=function(t){j=t};this.get=function(){return r};this.getSize=function(){return[e,d,b]};this.getMatrix=function(){return p};this.getFocalLength=function(){return b}};var Matrix3D=function(o,n,l,j,g,e,d,b,a,r,q,p,m,k,i,h){this.n11=o||1;this.n12=n||0;this.n13=l||0;this.n14=j||0;this.n21=g||0;this.n22=e||1;this.n23=d||0;this.n24=b||0;this.n31=a||0;this.n32=r||0;this.n33=q||1;this.n34=p||0;this.n41=m||0;this.n42=k||0;this.n43=i||0;this.n44=h||1;this.clone=function(){return new Matrix3D(this.n11,this.n12,this.n13,this.n14,this.n21,this.n22,this.n23,this.n24,this.n31,this.n32,this.n33,this.n34,this.n41,this.n42,this.n43,this.n44)};this.concat=function(t){var u={};u.n11=this.n11*t.n11+this.n12*t.n21+this.n13*t.n31+this.n14*t.n41;u.n12=this.n11*t.n12+this.n12*t.n22+this.n13*t.n32+this.n14*t.n42;u.n13=this.n11*t.n13+this.n12*t.n23+this.n13*t.n33+this.n14*t.n43;u.n14=this.n11*t.n14+this.n12*t.n24+this.n13*t.n34+this.n14*t.n44;u.n21=this.n21*t.n11+this.n22*t.n21+this.n23*t.n31+this.n24*t.n41;u.n22=this.n21*t.n12+this.n22*t.n22+this.n23*t.n32+this.n24*t.n42;u.n23=this.n21*t.n13+this.n22*t.n23+this.n23*t.n33+this.n24*t.n43;u.n24=this.n21*t.n14+this.n22*t.n24+this.n23*t.n34+this.n24*t.n44;u.n31=this.n31*t.n11+this.n32*t.n21+this.n33*t.n31+this.n34*t.n41;u.n32=this.n31*t.n12+this.n32*t.n22+this.n33*t.n32+this.n34*t.n42;u.n33=this.n31*t.n13+this.n32*t.n23+this.n33*t.n33+this.n34*t.n43;u.n34=this.n31*t.n14+this.n32*t.n24+this.n33*t.n34+this.n34*t.n44;u.n41=this.n41*t.n11+this.n42*t.n21+this.n43*t.n31+this.n44*t.n41;u.n42=this.n41*t.n12+this.n42*t.n22+this.n43*t.n32+this.n44*t.n42;u.n43=this.n41*t.n13+this.n42*t.n23+this.n43*t.n33+this.n44*t.n43;u.n44=this.n41*t.n14+this.n42*t.n24+this.n43*t.n34+this.n44*t.n44;this.initialize(u)};this.initialize=function(t){for(var u in t){this[u]=t[u]}};this.createBox=function(B,z,x,v,u,t,A,y,w){this.identity();if(v!=0){this.rotateX(v)}if(u!=0){this.rotateY(u)}if(t!=0){this.rotateZ(t)}if(B!=1||z!=1||x!=1){this.scale(B,z,x)}if(A!=0||y!=0||w!=0){this.translate(A,y,w)}};this.identity=function(){this.initialize({n11:1,n12:0,n13:0,n14:0,n21:0,n22:1,n23:0,n24:0,n31:0,n32:0,n33:1,n34:0,n41:0,n42:0,n43:0,n44:1})};this.rotateX=function(v){var t=Math.sin(v);var u=Math.cos(v);this.concat(new Matrix3D(1,0,0,0,0,u,-t,0,0,t,u,0,0,0,0,1))};this.rotateY=function(v){var t=Math.sin(v);var u=Math.cos(v);this.concat(new Matrix3D(u,0,t,0,0,1,0,0,-t,0,u,0,0,0,0,1))};this.rotateZ=function(v){var t=Math.sin(v);var u=Math.cos(v);this.concat(new Matrix3D(u,-t,0,0,t,u,0,0,0,0,1,0,0,0,0,1))};this.setRotateAxis=function(u,v){var F=Math.cos(v);var C=Math.sin(v);var G=1-F;var E=u.x();var D=u.y();var B=u.z();var A=G*E;var w=G*D;this.concat(A*E+F,A*D-C*B,A*B+C*D,0,A*D+C*B,w*D+F,w*B-C*E,0,A*B-C*D,w*B+C*E,G*B*B+F,0,0,0,0,1)};this.scale=function(v,u,t){this.concat(new Matrix3D(v,0,0,0,0,u,0,0,0,0,t,0,0,0,0,1))};this.translate=function(v,u,t){this.n41+=v;this.n42+=u;this.n43+=t};this.transformPoint=function(t){return new Vertex3D(this.n11*t.x+this.n21*t.y+this.n31*t.z+this.n41,this.n12*t.x+this.n22*t.y+this.n32*t.z+this.n42,this.n13*t.x+this.n23*t.y+this.n33*t.z+this.n43)};this.transformArray=function(u){var A=[];var B=u.length/3;for(var w=0;w<B;w++){var v=w*3;var t=u[v];var D=u[v+1];var C=u[v+2];A[v]=this.n11*t+this.n21*D+this.n31*C+this.n41;A[v+1]=this.n12*t+this.n22*D+this.n32*C+this.n42;A[v+2]=this.n13*t+this.n23*D+this.n33*C+this.n43}return A};this.makeFrustum=function(u,G,t,D,w,v){var H={};var F=2*w/(G-u);var C=2*w/(D-t);var E=(G+u)/(G-u);var B=(D+t)/(D-t);var A=-(v+w)/(v-w);var z=-2*v*w/(v-w);H.n11=F;H.n12=0;H.n13=E;H.n14=0;H.n21=0;H.n22=C;H.n23=B;H.n24=0;H.n31=0;H.n32=0;H.n33=A;H.n34=z;H.n41=0;H.n42=0;H.n43=-1;H.n44=0;this.concat(H)};this.makePerspective=function(x,v,z,u){var t=z*Math.tan(x*Math.PI/360);var y=-t;var A=y*v;var w=t*v;this.makeFrustum(A,w,y,t,z,u)};this.makeOrtho=function(v,I,F,t,C,B){var J={};var H=I-v;var A=F-t;var u=B-C;var G=(I+v)/H;var E=(F+t)/A;var D=(B+C)/u;J.n11=2/H;J.n12=0;J.n13=0;J.n14=-G;J.n21=0;J.n22=2/A;J.n23=0;J.n24=-E;J.n31=0;J.n32=0;J.n33=-2/u;J.n34=-D;J.n41=0;J.n42=0;J.n43=0;J.n44=1;this.concat(J)};this.toString=function(){return this.n11+","+this.n12+","+this.n13+","+this.n14+","+this.n21+","+this.n22+","+this.n23+","+this.n24+","+this.n31+","+this.n32+","+this.n33+","+this.n34+","+this.n41+","+this.n42+","+this.n43+","+this.n44}};frederickkPaper.FShape.FArrow=this.FArrow=Path.extend({initialize:function(h,d,k){this.path=new Path(h,d);k=(k!=undefined)?k:new Size(h.getDistance(d)*0.381924,h.getDistance(d)*0.381924);var b=Math.atan2(h.x-d.x,d.y-h.y);var g=[];g[0]=new Path(new Point(0,0),new Point(-k.width,-k.height));g[1]=new Path(new Point(0,0),new Point(k.width,-k.height));for(var e=0;e<g.length;e++){g[e].rotate(180+frederickkPaper.degrees(b),new Point(0,0));g[e].translate(h)}var j=new Group(this.path,g[0],g[1]);j.name="arrow";return j}});frederickkPaper.FShape.FBox=function(h){this.sides=new Array(6);this.name="";this.visible=true;this.selected=false;this.strokeCap;this.strokeJoin;var g=h;this.faceFRONT=[new frederickkPaper.F3D.FPoint3(-0.5,-0.5,-0.5),new frederickkPaper.F3D.FPoint3(0.5,-0.5,-0.5),new frederickkPaper.F3D.FPoint3(0.5,0.5,-0.5),new frederickkPaper.F3D.FPoint3(-0.5,0.5,-0.5)];this.faceTOP=[new frederickkPaper.F3D.FPoint3(-0.5,-0.5,0.5),new frederickkPaper.F3D.FPoint3(0.5,-0.5,0.5),new frederickkPaper.F3D.FPoint3(0.5,-0.5,-0.5),new frederickkPaper.F3D.FPoint3(-0.5,-0.5,-0.5)];this.faceBOTTOM=[new frederickkPaper.F3D.FPoint3(-0.5,0.5,0.5),new frederickkPaper.F3D.FPoint3(0.5,0.5,0.5),new frederickkPaper.F3D.FPoint3(0.5,0.5,-0.5),new frederickkPaper.F3D.FPoint3(-0.5,0.5,-0.5)];this.faceLEFT=[new frederickkPaper.F3D.FPoint3(-0.5,-0.5,-0.5),new frederickkPaper.F3D.FPoint3(-0.5,-0.5,0.5),new frederickkPaper.F3D.FPoint3(-0.5,0.5,0.5),new frederickkPaper.F3D.FPoint3(-0.5,0.5,-0.5)];this.faceRIGHT=[new frederickkPaper.F3D.FPoint3(0.5,-0.5,-0.5),new frederickkPaper.F3D.FPoint3(0.5,-0.5,0.5),new frederickkPaper.F3D.FPoint3(0.5,0.5,0.5),new frederickkPaper.F3D.FPoint3(0.5,0.5,-0.5)];this.faceBACK=[new frederickkPaper.F3D.FPoint3(-0.5,-0.5,0.5),new frederickkPaper.F3D.FPoint3(0.5,-0.5,0.5),new frederickkPaper.F3D.FPoint3(0.5,0.5,0.5),new frederickkPaper.F3D.FPoint3(-0.5,0.5,0.5)];var b=[["front",this.faceFRONT],["top",this.faceTOP],["bottom",this.faceBOTTOM],["left",this.faceLEFT],["right",this.faceRIGHT],["back",this.faceBACK]];var i=[1,1,1,1,1,1];var e=["normal","normal","normal","normal","normal","normal"];var d=[new paper.RGBColor(1,1,0,0.8),new paper.RGBColor(1,0,1,0.8),new paper.RGBColor(0,0,1,0.8),new paper.RGBColor(1,0,0,0.8),new paper.RGBColor(0,1,1,0.8),new paper.RGBColor(0,1,0,0.8)];var a=[new paper.RGBColor(1,1,0,0.8),new paper.RGBColor(1,0,1,0.8),new paper.RGBColor(0,0,1,0.8),new paper.RGBColor(1,0,0,0.8),new paper.RGBColor(0,1,1,0.8),new paper.RGBColor(0,1,0,0.8)];var j=[1,1,1,1,1,1];var k=new frederickkPaper.F3D.FPoint3(10,10,10);this.init=function(p,m,l){for(var q=0;q<b.length;q++){this.sides[q]=new frederickkPaper.F3D.FPath3();this.sides[q].name=b[q][0];var o=b[q][1];for(var n=0;n<o.length;n++){this.sides[q].add(new frederickkPaper.F3D.FPoint3(o[n].x()*k.x(),o[n].y()*k.y(),o[n].z()*k.z()))}this.sides[q].opacity=i[q];this.sides[q].blendMode=e[q];this.sides[q].visible=this.visible;this.sides[q].selected=this.selected;this.sides[q].fillColor=d[q];this.sides[q].strokeColor=a[q];this.sides[q].strokeWidth=j[q];this.sides[q].strokeCap=this.strokeCap;this.sides[q].strokeJoin=this.strokeJoin;this.sides[q].closed=true;this.sides[q].translate(p,m,l);g.addItem(this.sides[q])}};this.setSize=function(l,n,m){k.set(l,n,m)};this.setVisible=function(l){this.visible=l};this.setSelected=function(l){this.selected=l};this.setOpacity=function(l,m){if(l.length===undefined){i[l]=m}else{i=l}};this.setFillColor=function(m,l){if(m.length===undefined){d[m]=l}else{d=m}};this.setStrokeColor=function(m,l){if(m.length===undefined){a[m]=l}else{a=m}};this.setStrokeWidth=function(m,l){if(m.length===undefined){j[m]=l}else{j=m}};this.setStrokeCap=function(l){this.strokeCap=l};this.setStrokeJoin=function(l){this.strokeJoin=l};this.noFill=function(){d=[]};this.noStroke=function(){a=[]};this.get=function(){return this.sides};this.get=function(l){return this.sides[l]};this.getNumFaces=function(){return vertices.length-2};this.getSize=function(){return k}};frederickkPaper.FShape.FBubble=this.FBubble=Path.extend({defaultTagSize:new Size(20,20),initialize:function(i,d,a,k){a=(a!=undefined)?a:defaultTagSize;if(d.width<10){d.width=10;a=new Size(10,10)}k=(k!=undefined)?k:"RANDOM";this.path=new Path();this.path.name="bubble";this.path.add(new Point(0,0));var g=180;var b=new Point(d.height/2+Math.cos(f.radians(g))*(d.height),d.height/2+Math.sin(f.radians(g))*(d.height));this.path.arcTo(b,new Point(0,d.height));var e=frederickkPaper.randomInt(0,d.width-a.width);this.path.add(new Point(e,d.height));var j,h;if(k=="LEFT"){j=e}else{if(k=="CENTER"){j=e+(a.width/2)}else{if(k=="RIGHT"){j=e+a.width}else{j=frederickkPaper.randomInt(e,e+a.width)}}}h=d.height+a.height;this.path.add(new Point(j,h));this.path.add(new Point(e+a.width,d.height));this.path.add(new Point(d.width,d.height));g=0;b=new Point(d.height/2+Math.cos(f.radians(g))*(d.height/2),d.height/2+Math.sin(f.radians(g))*(d.height/2));this.path.arcTo(new Point(d.width,0),false);this.path.closed=true;this.path.position=new Point(i.x,i.y+(a.height/2));return this.path}});frederickkPaper.FShape.FChain=this.FChain=Path.extend({initialize:function(j,i,h,g){var e,d;var k=f.getType(j);if(k=="Point"){e=new Path.Circle(j,i);d=new Path.Circle(h,g)}else{if(k=="Path"){e=j;d=i}else{return}}var l=frederickkPaper.getCommonTangents(e,d);if(l!=null){this.path=new Path();this.path.name="chain";this.path.add(l[0]);this.path.add(l[1]);if(d.position.x>e.position.x){angle=0}else{if(d.position.y<e.position.y){angle=-90}else{if(d.position.y>e.position.y){angle=90}else{angle=180}}}var a=new Point(d.position.x+Math.cos(frederickkPaper.radians(angle))*(d.bounds.width/2),d.position.y+Math.sin(frederickkPaper.radians(angle))*(d.bounds.height/2));this.path.arcTo(a,l[2]);this.path.add(l[2]);this.path.add(l[3]);if(e.position.x>d.position.x){angle=0}else{if(e.position.y<d.position.y){angle=-90}else{if(e.position.y>d.position.y){angle=90}else{angle=180}}}var b=new Point(e.position.x+Math.cos(frederickkPaper.radians(angle))*(e.bounds.width/2),e.position.y+Math.sin(frederickkPaper.radians(angle))*(e.bounds.height/2));this.path.arcTo(b,l[0]);this.path.closed;return this.path}}});frederickkPaper.FShape.FCross=this.FCross=Path.extend({initialize:function(b,h,g,e){(g!=undefined)?g:1;(e!=undefined)?e:"LINE";var d,a;if(e=="LINE"){d=new paper.Path.Line(b.x+h.width,b.y-h.height,b.x-h.width,b.y+h.height);d.strokeWidth=g;a=new paper.Path.Line(b.x+h.width,b.y+h.height,b.x-h.width,b.y-h.height);a.strokeWidth=g}else{if(e=="SHARP"){d=new Path();d.add(b.x+h.width,b.y-h.height);d.add(b.x+h.width,(b.y-h.height)+(g/2));d.add((b.x-h.width)+(g/2),b.y+h.height);d.add(b.x-h.width,b.y+h.height);d.add(b.x-h.width,(b.y+h.height)-(g/2));d.add((b.x+h.width)-(g/2),b.y-h.height);d.closed=true;a=new Path();a.add(b.x-h.width,b.y-h.height);a.add((b.x-h.width)+(g/2),b.y-h.height);a.add(b.x+h.width,(b.y+h.height)-(g/2));a.add(b.x+h.width,b.y+h.height);a.add((b.x+h.width)-(g/2),b.y+h.height);a.add(b.x-h.width,(b.y-h.height)+(g/2));a.closed=true}}var i=new paper.Group(d,a);i.name="cross";return i}});frederickkPaper.FShape.FSphere=function(j){this.sides=[];this.vertices=[];this.name="";this.visible=true;this.selected=false;this.strokeCap;this.strokeJoin;var h=j;var b=10;var k=0.5;var i;var l;var n=[];var g=[];var d=[];var a=[];var m=[];var e=function(A,F){vertices=[];for(var u=0;u<=A;u++){var w=(Math.PI*(-k+((u-1)/A)));var z=Math.sin(w);var H=Math.cos(w);var r=(Math.PI*(-k+(u/A)));var t=Math.sin(r);var E=Math.cos(r);for(var p=0;p<=F;p++){var D=((Math.PI*2)*((p-1)/F));var G=Math.cos(D);var C=Math.sin(D);vertices.push(new frederickkPaper.F3D.FPoint3(G*H,C*H,z));vertices.push(new frederickkPaper.F3D.FPoint3(G*E,C*E,t))}}this.sides=new Array(vertices.length-2);n=new Array(vertices.length-2);g=new Array(vertices.length-2);d=new Array(vertices.length-2);a=new Array(vertices.length-2);m=new Array(vertices.length-2);var B=vertices.length-2;for(var u=0;u<B;u++){var I=vertices[u];var o=new paper.HSLColor(360*u/B,0.9,0.7);var q=(I.z()/h.getFocalLength())*100;n[u]=1;g[u]="normal";d[u]=o.darken(q);a[u]=o.darken(q);m[u]=1}};this.init=function(q,p,o){if(i==null){this.setLatsLongs(6,6)}for(var r=0;r<vertices.length-2;r++){this.sides[r]=new frederickkPaper.F3D.FPath3();this.sides[r].name="face"+r;this.sides[r].add(new frederickkPaper.F3D.FPoint3(vertices[r].x()*(b*0.5),vertices[r].y()*(b*0.5),vertices[r].z()*(b*0.5)));this.sides[r].add(new frederickkPaper.F3D.FPoint3(vertices[r+1].x()*(b*0.5),vertices[r+1].y()*(b*0.5),vertices[r+1].z()*(b*0.5)));this.sides[r].add(new frederickkPaper.F3D.FPoint3(vertices[r+2].x()*(b*0.5),vertices[r+2].y()*(b*0.5),vertices[r+2].z()*(b*0.5)));this.sides[r].opacity=n[r];this.sides[r].blendMode=g[r];this.sides[r].visible=this.visible;this.sides[r].selected=this.selected;this.sides[r].fillColor=d[r];this.sides[r].strokeColor=a[r];this.sides[r].strokeWidth=m[r];this.sides[r].strokeCap=this.strokeCap;this.sides[r].strokeJoin=this.strokeJoin;this.sides[r].closed=true;this.sides[r].translate(q,p,o);h.addItem(this.sides[r])}};this.setSize=function(o){b=o};this.setLatsLongs=function(p,o){i=(p<4)?4:p;l=(o<4)?4:o;e(i,l)};this.setVisible=function(o){this.visible=o};this.setSelected=function(o){this.selected=o};this.setOpacity=function(p,q){if(p.length===undefined){n[p]=q}else{n=p}};this.setFillColor=function(r,p){if(r.length===undefined){d[r]=p}else{for(var q=0;q<r.length;q++){var o=vertices[q];var t=(o.z()/h.getFocalLength())*100;d[q]=r.darken(t)}}};this.setStrokeColor=function(r,p){if(r.length===undefined){a[r]=p}else{for(var q=0;q<r.length;q++){var o=vertices[q];var t=(o.z()/h.getFocalLength())*100;a[q]=r.darken(t)}}};this.setStrokeWidth=function(p,o){if(p.length===undefined){m[p]=o}else{m=p}};this.setStrokeCap=function(o){this.strokeCap=o};this.setStrokeJoin=function(o){this.strokeJoin=o};this.noFill=function(){d=[]};this.noStroke=function(){a=[]};this.setVertices=function(o,p){if(o.length===undefined){vertices[o]=p}else{vertices=o}};this.get=function(){return this.sides};this.get=function(o){return this.sides[o]};this.getNumFaces=function(){return vertices.length-2};this.getVertices=function(){return vertices};this.getSize=function(){return b}};frederickkPaper.FControl=function(a){this.divId=a;this.addCheck=function(d,e){var b=document.createElement("input");b.setAttribute("type","chackbox");b.setAttribute("value",e);b.setAttribute("name",d);var g=document.createElement("div");g.appendChild(b);var h=document.getElementById(this.divId);h.appendChild(g)};this.addInput=function(d,e){var b=document.createElement("input");b.setAttribute("type","text");b.setAttribute("className","txt");b.setAttribute("value",e);b.setAttribute("name",d);var g=document.createElement("div");g.appendChild(b);var h=document.getElementById(this.divId);h.appendChild(g)}};